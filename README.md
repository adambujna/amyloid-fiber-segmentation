# Automated Segmentation of Amyloid Fibres from Electron Micrographs

This repository contains the source code and resources for the Bachelor's Thesis "Automated Segmentation of Amyloid Fibres from Electron Micrographs." The thesis focuses on developing and evaluating deep learning models for the instance segmentation of amyloid fibres, particularly in challenging conditions with high-density clustering and noise.

The core of this work includes a custom framework for generating synthetic electron microscopy (EM) images, along with pipelines for training and evaluating state-of-the-art models like YOLOv11 and the Segment Anything Model (SAM).

---

## Key Features
- Synthetic Data Generation: A procedural framework to generate synthetic EM images of amyloid fibres with control over clustering, signal-to-noise ratio, intensity, and other parameters.

- Tiling and Merging Pipeline: An advanced system for processing large-resolution micrographs by tiling them into smaller, overlapping patches for model inference and intelligently merging the results.

- Model Evaluation Framework: Scripts to quantitatively evaluate segmentation models using standard metrics (Precision, Recall, F1-Score) and custom metrics like length measurement error.

- Model Implementations: Ready-to-use segmenter classes for YOLOv11 and SAM, designed for the specific task of fibre segmentation.

---

## Project Structure

```
.
├── data/
│   ├── images/noise          # Pre-baked noise
│   ├── results/              # Results of evluations
│   ├── real_dataset/         # Real EM images and annotations
│   ├── yolo_dataset/         # Synthetic data generated by the framework in YOLO COCO segmentation format
│   └── sam_dataset/          # Synthetic data generated by the framework in SA1B format
├── model_checkpoints/        # Trained model weights (.pt files)
├── model_training/           # Output of model training
├── notebooks/                # Jupyter notebooks for analysis and visualizations
├── src/                      # Main source code
│   ├── __init__.py
│   ├── annotation_utils.py   # Helpers for loading/saving annotations
│   ├── data_utils.py         # Utilities for resizing, translating
│   ├── gui.py                # Plotting and visualization functions
│   ├── image_generator.py    # Functions for synthetic data creation
│   ├── image_processing.py   # Image manipulation functions
│   ├── model_eval.py         # Scripts for model evaluation
│   ├── models.py             # Main classes for YOLO and SAM segmenters
│   ├── procedural_noise/     # Cellular and Simplex noise implementations
│   └── tiling.py             # Functions for image and annotation tiling and reconstruction
├── README.md
└── requirements.txt          # Dependencies
```


